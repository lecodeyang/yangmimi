## [三次握手 四次挥手](https://www.jianshu.com/p/12790cea57ac)

## 网络基础知识

**一．IP地址**

  IP地址是因特网上的每个网络节点在全球范围内的唯一标识符，对每个节点来说，IP地址是一个32位的二进制代码，如11111111111111111111111111111111。为了提高可读性，我们常常把32位IP地址中的每8位转换为对应的十进制，并在两个十进制数之间插入一个点，即255.255.255.255，这种记法就是常用的点分十进制记法。

​    IP地址的编址经历了三个历史阶段，分类的IP地址、子网的划分以及构成超网。

**1.1分类的IP地址**

​    分类的IP地址中是将IP划分为几种固定的类，每一类地址都有两个固定长度的字段组成--网络号和主机号。网络号是标志网络节点所连接到的网络，主机号标志该节点。IP地址主要分为5大类，A类、B类和C类都是单播地址，即一对一通信，最常用。D类地址用于多播，即一对多通信。E类地址保留为以后用。如图可见这几类IP：

![img](https://img-blog.csdn.net/20160728143716944?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center)



​    A类地址规定网络号字段为1字节，第一位固定为0来标识该类别，只有7位可供使用，有=126个可指派的网络号。其中有2个特殊的网络号，一个是网络号字段为全0，它是保留地址，意思是“本网络”，如0.0.0.35代表“在这个网络上主机号为35的主机”；另一个是127字段，保留用于环回测试，例，常见的127.0.0.1代表本地主机。所以A类地址的网络号范围为1～126。主机号3字节，最大主机数为，这里也要减去2。一个是主机号全0，表示网络的地址，如，一主机IP为5.6.7.8，则该主机所在的网络地址就是5.0.0.0。另一个是全1，表示该网络内的所有主机，如，125.255.255.255代表了125.0.0.0这个网络上的所有主机。

​    B类地址网络号字段为2字节，前两位固定为10，有14位可用来分配，有个可指派的网络号。这里减1的原因是一般128.0.0.0是不指派的，B类可指派的网络地址是128.1.0.0。

​    C类地址网络号字段为3字节，前3位固定为110，有21为可用来分配。

   由上我们可以简单看出，整个IP地址空间共有个地址，Ａ类地址有个，占有整个IP地址空间的50%，B类占有25%，C类占有12.5%。

**1.2划分子网**

​    上一节中介绍的分类的IP地址是二级IP地址，是由网络号和主机号组成的，而现在常用的是三级IP地址，添加了一个子网号。二级的IP不够灵活且造成了浪费。如，我们办公室假如有300台电脑，使用C类地址，最多可接入=256台主机，显然不够，若使用B类地址，则可接入=65536台主机，造成了极大的浪费。此时，我们可以申请一个B类的网络，如网络地址为172.16.0.0，同时可以把这65536个地址划分成一个个局域网，相互之间互不干扰，划分过的局域网可以称为这个B类网络的一个个子网，而相对于本单位外的网络仍然表现为一个网络。网络号是需要申请和指派的，它一般是固定的，所以想要进行子网的划分，划分的方法是将二级IP的主机号字段借用若干位来表示子网号，这样就变成了三级IP地址：网络号、子网号和主机号。记为：

  IP地址：：={<网络号>，<子网号>，<主机号>}

​    但一个数据报到达公司的路由器后，路由器并不知道该发给哪个子网，因为子网号并不一定存在，就算存在位数也并不是固定的，所以此时就需要子网掩码。

​    子网掩码这个概念主要为了确定IP地址的网络号，这里所说的网络号不再是二级IP中的网络号，而是指的是三级IP地址中网络号和子网号两者的总和。这样，总的来说子网掩码将三级IP地址分成了两部分，即网络号和主机号（注意这里的网络号和主机号与二级IP的网络号和主机号的异同）。

​    我们知道二进制中任何数逐位与1进行“与”操作后还是本身，和0进行“与”操作后都是0。其实一个子网掩码的实质是指定了一个IP地址中网络号的长度，如一IP地址为01110110.10110110.11010101.00101011，子网掩码是11111111.11100000.00000000.00000000，它的前11位就设置为1，后21位设置为0，IP地址和子网掩码进行“与”操作后，该IP地址的前11位就保留了下来，后21位就变为了全0，即01110110.10100000.00000000.00000000。

​    如果一个网络不划分子网，那么该网络的子网掩码使用默认子网掩码，这种默认子网掩码其实就三个。即A类地址的默认子网掩码，255.0.0.0，B类地址的默认子网掩码255.255.0.0，C类地址的默认子网掩码255.255.255.0。

​    顺便说一下，有一种IP表示方法，如192.168.1.0/24，它指的是IP地址是192.168.1.0，子网掩码中1的个数是24个，即255.255.255.0，很容易看出这个就是一个C类的网络。再如，我们办公室网络中有172.16.0.X和172.16.1.X这两种IP，简单分析，172即B类地址，默认网络号是16位，即172.16，但只出现过0.X和1.X的IP说明第三个八位中前七位应该是固定的，只有最后一位在0和1之间变化，所以我们办公室网络的网络号应该是23位，子网掩码是255.255.254.0。

**二．网关**

​    网关是一个网段的出入口。一个网络想要和这个网络外的网络进行通信，必须通过网关。如我们要登录百度页面，主机发现数据包的目的主机不在本地网络中，就把数据包转发给自己的网关，再由网关转发给百度的网关，百度的网关再转发给百度中的某个服务器上，这样，百度就收到了我们的登录请求，它就把数据包传给我们，百度的网关要先找到我们本地的网关，网关收到数据包后再转发给我们。

​    一个网段是可以没有网关，也可以没有DHCP服务器，即设置为静态IP，由交换机、集线器等连接设备就可相互访问。但没有网关就意味着只能在这个局域网内互相访问，不能访问局域网外的任何网络。很多局域网中都采用了路由来接入网络，路由器的WAN口连接到外部网络上，LAN口IP设置为网关。网关的地址可以是局域网段内主机地址的任意一个，不一定是设置为192.168.1.0，它只是用来标识网关。

**三．几种常用网络设备**

**3.1中继器**

​    信号在双绞线中传输的过程中信号的功率会逐渐衰减，当信号衰减到一定程度时将造成信号失真，所以为了方便较远距离的两计算机进行通信，就在这两个计算机之间安装一个中继器，让信号能传的更远。中继器的作用就是整理已经衰减的信号，重新产生完整的信号再继续传送。中继器工作在物理层，只是起到了扩展传输距离的作用，对高层是透明的。

**3.2集线器**

​    集线器实际上就是一种多端口的中继器，一般有4、8、16、24、32等数量的接口。如一台集线器有8个接口，连接了8台计算机，那集线器就位于这8台计算机的“中心”，每台计算机想与其他计算机进行通信时，计算机首先要将数据包通过双绞线送到集线器上，而集线器是用广播的方式将包同时发给8个端口，8个端口的计算机收到广播信息后对信息进行检查，是发给自己的就接收，不是的话就不理睬。正是因为广播的这种机制，我们将我们自己的电脑连在集线器上，才能抓到ucm和话机等进行通信的数据包。同样，集线器也是工作在物理层。

![img](https://img-blog.csdn.net/20160728144213123?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast)



**3.3网桥**

​    网桥是早期的两端口的二层网络设备，网桥像是一个聪明的中继器，如前所说，中继器只是简单的连接了两个网络，任何数据都可以通过中继器发出，但网桥有所不同。网桥除了扩展网络的距离或范围，还能提高网络的性能和安全性。

![img](https://img-blog.csdn.net/20160728144343374?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast)



​    网桥可以连接两个网络，网桥A端口连接A子网，B端口连接B子网。网桥中有一个信息表，我们可以把这个信息表看作两部分，一部分记录了A子网中设备的MAC地址，另一部分记录了B子网中的MAC地址，当Ａ发出一个包，网桥可以查看目的地址到底是Ａ中的还是B中的，若是Ａ中的就不进行转发，是B中的才进行转发。所以网桥与中继器不同的是隔离了两个子网，而不是任意的转发，拥有了学习功能。

**3.4交换机**

​    网桥只有两个端口，有着局限，所以为了实现多对多通信，产生了交换机。集线器同样也是多对多通信，但集线器是广播的方式将数据包发到目的主机上，交换机却不一样，交换机与网桥一样具有学习功能。

![img](https://img-blog.csdn.net/20160728144524361?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast)



​    交换机也有一个表，它记录着每个端口对应的主机的MAC地址。当交换机收到数据包后，可以解析出该数据包目的地址的MAC地址。然后根据该MAC地址将包转发到对应的端口去。

​    交换机有很多的类型，我们常说的交换机一般指的是传统的交换机，它工作在二层。但随着交换机的发展，出现了三层交换机，它除了拥有二层交换机的交换技术外，还在三层实现了数据包的高速转发及路由功能。

**3.5路由器**

​    子网划分中我们介绍到经常将一个网络划分成一个个的子网，每个子网拥有不同的网段。二层交换机只能实现连在它上面的同一个网段的主机之间的通信，如果是不同的网段就算连在同一个交换机上仍相互不能进行通信。而路由器就可以实现不同网段之间的通信，它是一种连接多个网络或网段的设备，能将不同网络或网段之间的数据进行“翻译”，并可以识别出一个数据包应该转发到哪个网络中。

![img](https://img-blog.csdn.net/20160728144651457?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast)



​    路由器中一般有个路由表来实现学习和翻译的功能。如图，我们UCM在作为路由器时的路由表，记录了目的地、网关、子网掩码和接口等。如路由表中的第二条代表的意思是：如果目的地是172.16.0.0网段，那就把数据包转发到eth1端口上去。第一条是默认路由，就是如果目的地不在这个路由表中，那就走这条默认路由。

**3.6调制解调器**

​    还有一种家中常用的设备，那就是调制解调器，也就是俗称的“猫”。我们都知道，网线中一般传输的数字信号，0和1，而电话线中传输的是模拟信号，这两种信号并不能直接进行通信，就需要调制解调器进行“翻译”。